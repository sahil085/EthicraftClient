<div class="row" id="pendingRequestBlock">
  <div class="col-lg-12">
    <div class="ibox float-e-margins">
      <div class="ibox-title">
        <h5>Add User Role</h5>

        <div class="ibox-tools">
          <a class="collapse-link">
            <i class="fa fa-chevron-up"></i>
          </a>
        </div>
      </div>

      <div class="ibox-content">

        <form name="assignRoleForm" id="assignRole" class="example-form">
          <div class="table-responsive">
            <table class="table">
              <thead>
              <tr>
                <th>User Name</th>
                <th>User Role</th>
                <th>Colleges</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td>
                  <mat-form-field class="input-full-width">
                    <input
                      type="text"
                      placeholder="Username"
                      aria-label="Number"
                      matInput
                      [formControl]="username"
                      [matAutocomplete]="auto"
                      required
                    >
                    <mat-autocomplete #auto="matAutocomplete">
                      <mat-option *ngFor="let username of filteredUsername | async" [value]="username">
                        {{username}}
                      </mat-option>
                    </mat-autocomplete>
                    <mat-error *ngIf="username.hasError('required')">
                      Please select any username
                    </mat-error>
                    <mat-error *ngIf="username.hasError('email')">
                      Username must be a valid email id
                    </mat-error>
                  </mat-form-field>
                </td>
                <td>
                  <mat-form-field>
                    <mat-label>Role</mat-label>
                    <mat-select [formControl]="userRole" (selectionChange)="changeSelection()" required>
                      <mat-option *ngFor="let role of roles" [value]="role">{{role}}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="userRole.hasError('required')">
                      Please select any role
                    </mat-error>
                  </mat-form-field>
                </td>
                <td>
                  <mat-form-field >
                    <mat-label>Colleges</mat-label>
                    <mat-select [formControl]="colleges" [disabled]="!showCollegeSelect" multiple>
                      <mat-option *ngFor="let college of collegeList" [value]="college.id">{{college.collegeName}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td></td>
                <td></td>
                <td>
                  <div style="float:right">
                    <button class="btn btn-sm btn-primary submitAssignRole" type="submit" (click)="submitForm()">
                      <strong>Assign Role</strong>
                    </button>
                  </div>
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </form>
      </div>
    </div>
  </div>

</div>

<div class="row">
  <div class="col-lg-12">
    <div class="ibox float-e-margins">
      <div class="ibox-title">
        <h5>User Role</h5>

        <div class="ibox-tools">
          <a class="collapse-link">
            <i class="fa fa-chevron-up"></i>
          </a>
        </div>
      </div>

      <div class="ibox-content">
        <table id="viewUserRoleTable" class="table table-responsive table-striped">
          <thead>
          <tr>
            <th>User Name</th>
            <th>User Email</th>
            <th>Role</th>
            <th>Colleges</th>
            <th>Action</th>
          </tr>
          </thead>
          <tbody>
          <tr class="p-h-md" *ngFor="let userRole of userRoleCollegeMappingList">
            <td>{{userRole.userName}}</td>
            <td>{{userRole.userEmail}}</td>
            <td>{{userRole.role}}</td>
            <td>
              {{userRole.collegeName}}
            </td>
            <td>
              <a title="Delete activity" (click)="deleteUserRole(userRole.id)"><i class="fa fa-trash p-xs"></i></a>
              <a *ngIf="userRole.collegeName && roleCA !== userRole.role"  (click)="editUserRoleMapping(userRole.id)" title="Edit user role"><i class="fa fa-pencil p-xs"></i></a>
            </td>
          </tr>
          </tbody>
        </table>

      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Update User Role College Mapping</h4>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-lg-12">
            <div class="ibox float-e-margins">

              <div class="ibox-content">

                <div class="row">
                  <div class="col-md-12">
                    <!--<ng-select [multiple]="true" [(ngModel)]="selectedCars">-->
                      <!--<ng-option *ngFor="let car of cars" [value]="car.id" [disabled]="car.disabled">{{car.name}}</ng-option>-->
                      <!--<ng-option [value]="'custom'">Custom</ng-option>-->
                    <!--</ng-select>-->
                    <label for="updateUserRoleCollegeMapping">Colleges</label>
                    <ng-select id="updateUserRoleCollegeMapping" required [(ngModel)]="updateColleges" [multiple]="true">
                      <ng-option *ngFor="let college of collegeList" [value]="college.id">{{college.collegeName}}</ng-option>
                    </ng-select>
                    <h3 class="red-bg font-bold" *ngIf="updateColleges.length === 0">Required field</h3>
                    <!--<select id="updateUserRoleCollegeMapping"  required class="chosen-select" label="" multiple >-->
                      <!--<option *ngFor="let college of collegeList" [value]="college.id">{{college.collegeName}}</option>-->
                    <!--</select>-->
                  </div>
                  <!--<form>-->
                    <!--<mat-form-field >-->
                      <!--<mat-label>Colleges</mat-label>-->
                      <!--<mat-select [formControl]="updateCollegeList" multiple>-->
                        <!--<mat-option *ngFor="let college of collegeList" [value]="college.id">{{college.collegeName}}</mat-option>-->
                      <!--</mat-select>-->
                    <!--</mat-form-field>-->
                  <!--</form>-->


                </div>
            </div>
          </div>

        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-sm btn-primary submitAssignRole" type="submit" (click)="update()">
          <strong>Update</strong>
        </button>
      </div>
    </div>

  </div>
</div>



